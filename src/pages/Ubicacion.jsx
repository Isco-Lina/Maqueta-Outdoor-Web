import "../styles/ubicacion.css";

export default function Ubicacion({ cart = [], company }) {
  // 1) Carrito: si no llega por props, levanta del localStorage
  const cartFromLS = (() => {
    try {
      return JSON.parse(localStorage.getItem("weke-cart") || "[]");
    } catch {
      return [];
    }
  })();
  const effectiveCart = Array.isArray(cart) && cart.length ? cart : cartFromLS;

  // 2) Datos base de la empresa (sobrescribibles por prop `company`)
  const COMPANY = {
    nombre: "Outdoor Gear Montalay (Maqueta)",
    whatsappIntl: "56964344326", // sin "+"
    salesEmail: "outdoorgear@gmail.com",
    telefonoFijo: "+56 2 2345 6789",
    horario: "Lun a Vie 10:00‚Äì19:00 ¬∑ S√°b 10:00‚Äì14:00",
    sucursales: [
      {
        nombre: "Casa Matriz - Santiago",
        direccion: "Av. Andr√©s Bello 1234, Providencia, RM",
        telefono: "+56 9 1111 1111",
      },
    ],
    ...(company || {}),
  };

  return (
    <section className="container my-5 ubicacion-page">
      <header className="mb-4">
        <h1 className="m-0">Ubicaci√≥n y Cobertura</h1>
        <p className="text-muted m-0">
          Encu√©ntranos en nuestra casa matriz y revisa c√≥mo despachamos a todo
          Chile.
        </p>
      </header>

      <div className="row g-4">
        {/* Sucursal */}
        <div className="col-12 col-lg-6">
          <div className="card h-100 shadow-sm">
            <div className="card-body">
              <h5 className="card-title">Sucursal</h5>
              {COMPANY.sucursales.map((s) => (
                <div key={s.nombre} className="mb-3">
                  <div className="fw-semibold">{s.nombre}</div>
                  <div className="text-muted">{s.direccion}</div>
                  <div className="mt-1">
                    <a
                      className="link-body-emphasis"
                      href={`tel:${s.telefono.replace(/\s+/g, "")}`}
                    >
                      {s.telefono}
                    </a>
                  </div>
                </div>
              ))}

              <hr className="my-3" />

              {/* Contacto empresa */}
              <h6 className="subtitle mt-2">Outdoor Gear Montalay</h6>
              <ul className="list-unstyled m-0 small contact-list">
                <li>
                  üìû Tel√©fono:{" "}
                  <a href={`tel:${COMPANY.telefonoFijo.replace(/\s+/g, "")}`}>
                    {COMPANY.telefonoFijo}
                  </a>
                </li>
                <li>
                  üí¨ WhatsApp ventas:{" "}
                  <a
                    target="_blank"
                    rel="noreferrer"
                    href={`https://wa.me/${COMPANY.whatsappIntl}`}
                  >
                    +{COMPANY.whatsappIntl}
                  </a>
                </li>
                <li>
                  ‚úâÔ∏è Correo:{" "}
                  <a href={`mailto:${COMPANY.salesEmail}`}>
                    {COMPANY.salesEmail}
                  </a>
                </li>
                <li>‚è∞ Horario: {COMPANY.horario}</li>
              </ul>
            </div>
          </div>
        </div>

        {/* Cobertura & Env√≠os */}
        <div className="col-12 col-lg-6">
          <div className="card h-100 shadow-sm">
            <div className="card-body">
              <h5 className="card-title">Cobertura y Env√≠os</h5>
              <ul className="m-0 p-0 bullet-list">
                <li>
                  Despacho a domicilio a todo Chile v√≠a{" "}
                  <strong>Starken / Chilexpress / Bluexpress</strong>.
                </li>
                <li>Retiro en sucursal (por pagar) disponible.</li>
                <li>
                  Preparaci√≥n: <strong>24‚Äì48h h√°biles</strong>.
                </li>
                <li>
                  <strong>RM:</strong> 1‚Äì3 d√≠as h√°biles &nbsp;¬∑&nbsp;{" "}
                  <strong>Regiones:</strong> 2‚Äì6 d√≠as h√°biles.
                </li>
                <li>Seguimiento con n√∫mero de env√≠o.</li>
              </ul>
            </div>
          </div>
        </div>

        {/* Mapa embebido */}
        <div className="col-12">
          <div className="border rounded-4 overflow-hidden">
            <iframe
              title="Mapa tienda"
              src="https://www.google.com/maps?q=Av.+Andr%C3%A9s+Bello+1234,+Providencia,+Chile&output=embed"
              width="100%"
              height="320"
              style={{ border: 0 }}
              loading="lazy"
              referrerPolicy="no-referrer-when-downgrade"
            />
          </div>
        </div>

        {/* Preguntas frecuentes */}
        <div className="col-12">
          <div className="border rounded-4 p-3">
            <h5 className="mb-3">Preguntas frecuentes</h5>

            <details className="mb-2">
              <summary className="fw-semibold">
                ¬øCu√°nto cuesta el env√≠o?
              </summary>
              <div className="text-muted">
                Depende de peso/volumen y destino. Lo confirmamos por WhatsApp o
                Email antes de cerrar el pedido.
              </div>
            </details>

            <details className="mb-2">
              <summary className="fw-semibold">
                ¬øQu√© medios de pago aceptan?
              </summary>
              <div className="text-muted">
                Te enviaremos link de pago o datos para transferencia.
              </div>
            </details>

            <details className="mb-2">
              <summary className="fw-semibold">
                ¬øPuedo retirar en tienda?
              </summary>
              <div className="text-muted">
                S√≠, coordinamos d√≠a y hora en la sucursal que prefieras.
              </div>
            </details>
          </div>
        </div>
      </div>
    </section>
  );
}
